{"version":3,"sources":["../../../../src/app/%28main%29/admin/%28admin%29/email-templates/%5Bid%5D/admin-email-templates-detail-client.tsx"],"sourcesContent":["'use client';\n\n// =============================================================\n// FILE: src/app/(main)/admin/(admin)/email-templates/[id]/admin-email-templates-detail-client.tsx\n// FINAL — Admin Email Template Create/Edit Form (App Router + shadcn)\n// - Modern UI with shadcn/ui components\n// - Tailwind CSS with dark mode support\n// - RTK Query hooks\n// - HTML content editor (Textarea)\n// - Variables input (comma-separated or JSON)\n// =============================================================\n\nimport * as React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { toast } from 'sonner';\nimport { ArrowLeft, Save, Trash2, Loader2, Code2, Mail } from 'lucide-react';\n\nimport { useAdminLocales } from '@/app/(main)/admin/_components/common/useAdminLocales';\nimport { localeShortClient, localeShortClientOr } from '@/i18n/localeShortClient';\n\nimport { cn } from '@/lib/utils';\n\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { AdminLocaleSelect } from '@/app/(main)/admin/_components/common/AdminLocaleSelect';\n\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\n\nimport type { EmailTemplateAdminCreatePayload } from '@/integrations/shared';\nimport {\n  useGetEmailTemplateAdminQuery,\n  useCreateEmailTemplateAdminMutation,\n  useUpdateEmailTemplateAdminMutation,\n  useDeleteEmailTemplateAdminMutation,\n} from '@/integrations/hooks';\n\ntype FormData = {\n  template_key: string;\n  template_name: string;\n  subject: string;\n  content: string;\n  variables: string; // comma-separated or JSON string\n  is_active: boolean;\n  locale: string;\n};\n\nfunction getErrMsg(e: unknown): string {\n  const anyErr = e as any;\n  return (\n    anyErr?.data?.error?.message ||\n    anyErr?.data?.message ||\n    anyErr?.message ||\n    'İşlem başarısız'\n  );\n}\n\nfunction parseVariables(input: string): string[] | null {\n  const trimmed = input.trim();\n  if (!trimmed) return null;\n\n  // Try JSON first\n  if (trimmed.startsWith('[')) {\n    try {\n      const parsed = JSON.parse(trimmed);\n      if (Array.isArray(parsed)) {\n        return parsed.filter((v) => typeof v === 'string' && v.trim());\n      }\n    } catch {\n      // Fall through to comma-separated\n    }\n  }\n\n  // Comma-separated\n  return trimmed\n    .split(',')\n    .map((v) => v.trim())\n    .filter(Boolean);\n}\n\nfunction stringifyVariables(vars: string[] | null | undefined): string {\n  if (!vars || vars.length === 0) return '';\n  return vars.join(', ');\n}\n\nexport default function AdminEmailTemplatesDetailClient({ id }: { id: string }) {\n  const router = useRouter();\n  const isNew = id === 'new';\n\n  // Locale management\n  const { localeOptions, defaultLocaleFromDb, coerceLocale, loading: localesLoading } = useAdminLocales();\n\n  // RTK Query - only fetch if editing\n  const {\n    data: existingItem,\n    isLoading: loadingItem,\n    error: loadError,\n  } = useGetEmailTemplateAdminQuery(\n    { id },\n    { skip: isNew }\n  );\n\n  const [createTemplate, { isLoading: isCreating }] = useCreateEmailTemplateAdminMutation();\n  const [updateTemplate, { isLoading: isUpdating }] = useUpdateEmailTemplateAdminMutation();\n  const [deleteTemplate, { isLoading: isDeleting }] = useDeleteEmailTemplateAdminMutation();\n\n  // Form state\n  const [formData, setFormData] = React.useState<FormData>({\n    template_key: '',\n    template_name: '',\n    subject: '',\n    content: '',\n    variables: '',\n    is_active: true,\n    locale:\n      defaultLocaleFromDb ||\n      localeShortClientOr(typeof window !== 'undefined' ? navigator.language : 'de', 'de') ||\n      '',\n  });\n\n  // Delete dialog state\n  const [deleteDialogOpen, setDeleteDialogOpen] = React.useState(false);\n\n  // Load existing data\n  React.useEffect(() => {\n    if (!isNew && existingItem) {\n      // For edit mode, we might have translations\n      // Use the first translation or default to empty\n      const firstTranslation = existingItem.translations?.[0];\n\n      setFormData({\n        template_key: existingItem.template_key || '',\n        template_name: firstTranslation?.template_name || '',\n        subject: firstTranslation?.subject || '',\n        content: firstTranslation?.content || '',\n        variables: stringifyVariables(existingItem.variables),\n        is_active: existingItem.is_active,\n        locale:\n          firstTranslation?.locale ||\n          defaultLocaleFromDb ||\n          localeShortClientOr(typeof window !== 'undefined' ? navigator.language : 'de', 'de') ||\n          '',\n      });\n    }\n  }, [existingItem, isNew, defaultLocaleFromDb]);\n\n  // Update default locale if needed\n  React.useEffect(() => {\n    if (isNew && defaultLocaleFromDb && !formData.locale) {\n      setFormData((prev) => ({ ...prev, locale: defaultLocaleFromDb }));\n    }\n  }, [isNew, defaultLocaleFromDb, formData.locale]);\n\n  const busy = isCreating || isUpdating || isDeleting || loadingItem;\n\n  const handleSave = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    // Validation\n    if (!formData.template_key.trim()) {\n      toast.error('Template Key gerekli');\n      return;\n    }\n\n    if (!formData.template_name.trim()) {\n      toast.error('Template Name gerekli');\n      return;\n    }\n\n    if (!formData.subject.trim()) {\n      toast.error('Subject gerekli');\n      return;\n    }\n\n    if (!formData.content.trim()) {\n      toast.error('Content gerekli');\n      return;\n    }\n\n    // ✅ Sadece locale normalize et\n    const apiLocale = localeShortClient(formData.locale);\n    const parsedVariables = parseVariables(formData.variables);\n\n    try {\n      if (isNew) {\n        const payload: EmailTemplateAdminCreatePayload = {\n          template_key: formData.template_key.trim(),\n          template_name: formData.template_name.trim(),\n          subject: formData.subject.trim(),\n          content: formData.content.trim(),\n          variables: parsedVariables,\n          is_active: formData.is_active,\n          locale: apiLocale,\n        };\n\n        await createTemplate(payload).unwrap();\n        toast.success('Şablon oluşturuldu');\n        router.push('/admin/email-templates');\n      } else {\n        await updateTemplate({\n          id,\n          body: {\n            template_key: formData.template_key.trim(),\n            template_name: formData.template_name.trim(),\n            subject: formData.subject.trim(),\n            content: formData.content.trim(),\n            variables: parsedVariables,\n            is_active: formData.is_active,\n            locale: apiLocale,\n          },\n        }).unwrap();\n        toast.success('Şablon güncellendi');\n      }\n    } catch (err) {\n      toast.error(getErrMsg(err));\n    }\n  };\n\n  const handleDeleteClick = () => {\n    setDeleteDialogOpen(true);\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (isNew) return;\n\n    try {\n      await deleteTemplate({ id }).unwrap();\n      toast.success('Şablon silindi');\n      router.push('/admin/email-templates');\n    } catch (err) {\n      toast.error(getErrMsg(err));\n    }\n  };\n\n  const handleLocaleChange = (locale: string) => {\n    const coerced = coerceLocale(locale, defaultLocaleFromDb);\n    setFormData((prev) => ({ ...prev, locale: coerced }));\n  };\n\n  if (loadError) {\n    return (\n      <div className=\"space-y-6\">\n        <Card>\n          <CardContent className=\"py-12 text-center\">\n            <div className=\"text-destructive\">\n              Kayıt yüklenemedi: {getErrMsg(loadError)}\n            </div>\n            <Button\n              variant=\"outline\"\n              onClick={() => router.push('/admin/email-templates')}\n              className=\"mt-4 gap-2\"\n            >\n              <ArrowLeft className=\"size-4\" />\n              Listeye Dön\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!isNew && loadingItem) {\n    return (\n      <div className=\"space-y-6\">\n        <Card>\n          <CardContent className=\"flex items-center justify-center py-12\">\n            <div className=\"flex items-center gap-2\">\n              <Loader2 className=\"size-5 animate-spin\" />\n              <span>Yükleniyor...</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <form onSubmit={handleSave} className=\"space-y-6\">\n        {/* Header */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between\">\n              <div className=\"space-y-1.5\">\n                <CardTitle>\n                  {isNew ? 'Yeni Email Template' : 'Email Template Düzenle'}\n                </CardTitle>\n                <CardDescription>\n                  {isNew\n                    ? 'Yeni bir email şablonu oluşturun'\n                    : 'Mevcut email şablonunu düzenleyin'}\n                </CardDescription>\n              </div>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => router.push('/admin/email-templates')}\n                disabled={busy}\n                className=\"gap-2\"\n              >\n                <ArrowLeft className=\"size-4\" />\n                Geri\n              </Button>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Section 1: Metadata */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">Genel Bilgiler</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"grid gap-4 sm:grid-cols-3\">\n              {/* Locale */}\n              <div>\n                <AdminLocaleSelect\n                  value={formData.locale}\n                  onChange={handleLocaleChange}\n                  options={localeOptions}\n                  loading={localesLoading}\n                  disabled={busy}\n                />\n              </div>\n\n              {/* Active */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"is_active\" className=\"text-sm\">\n                  Durum\n                </Label>\n                <div className=\"flex items-center gap-3 rounded-md border px-3 py-2\">\n                  <Switch\n                    id=\"is_active\"\n                    checked={formData.is_active}\n                    onCheckedChange={(checked) =>\n                      setFormData((prev) => ({ ...prev, is_active: checked }))\n                    }\n                    disabled={busy}\n                  />\n                  <Label htmlFor=\"is_active\" className=\"cursor-pointer text-sm\">\n                    {formData.is_active ? (\n                      <Badge variant=\"default\">Aktif</Badge>\n                    ) : (\n                      <Badge variant=\"secondary\">Pasif</Badge>\n                    )}\n                  </Label>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 2: Template Info */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">Şablon Bilgileri</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {/* Template Key */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"template_key\" className=\"text-sm\">\n                <div className=\"flex items-center gap-2\">\n                  <Code2 className=\"size-4\" />\n                  Template Key <span className=\"text-destructive\">*</span>\n                </div>\n              </Label>\n              <Input\n                id=\"template_key\"\n                value={formData.template_key}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, template_key: e.target.value }))\n                }\n                placeholder=\"welcome_email\"\n                disabled={busy || !isNew} // Key cannot be changed after creation\n                required\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Benzersiz anahtar (değiştirilemez). Örn: welcome_email, password_reset\n              </p>\n            </div>\n\n            {/* Template Name */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"template_name\" className=\"text-sm\">\n                Template Name <span className=\"text-destructive\">*</span>\n              </Label>\n              <Input\n                id=\"template_name\"\n                value={formData.template_name}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, template_name: e.target.value }))\n                }\n                placeholder=\"Hoş Geldiniz Emaili\"\n                disabled={busy}\n                required\n              />\n            </div>\n\n            {/* Subject */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"subject\" className=\"text-sm\">\n                <div className=\"flex items-center gap-2\">\n                  <Mail className=\"size-4\" />\n                  Subject <span className=\"text-destructive\">*</span>\n                </div>\n              </Label>\n              <Input\n                id=\"subject\"\n                value={formData.subject}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, subject: e.target.value }))\n                }\n                placeholder=\"Hoş Geldiniz {{name}}!\"\n                disabled={busy}\n                required\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Email konusu. Değişkenler için &#123;&#123;variable&#125;&#125; kullanın.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 3: Content */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">Email İçeriği</CardTitle>\n            <CardDescription>\n              HTML içerik. Değişkenler için &#123;&#123;variable&#125;&#125; formatını kullanın.\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {/* Content */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"content\" className=\"text-sm\">\n                HTML Content <span className=\"text-destructive\">*</span>\n              </Label>\n              <Textarea\n                id=\"content\"\n                value={formData.content}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, content: e.target.value }))\n                }\n                placeholder={`<html>\n  <body>\n    <h1>Merhaba {{name}}!</h1>\n    <p>Hoş geldiniz...</p>\n  </body>\n</html>`}\n                disabled={busy}\n                rows={12}\n                required\n                className=\"font-mono text-xs\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 4: Variables */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">Değişkenler</CardTitle>\n            <CardDescription>\n              Email içeriğinde kullanılan değişkenleri tanımlayın (opsiyonel)\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {/* Variables */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"variables\" className=\"text-sm\">\n                Variables\n              </Label>\n              <Textarea\n                id=\"variables\"\n                value={formData.variables}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, variables: e.target.value }))\n                }\n                placeholder='name, email, url veya [\"name\", \"email\", \"url\"]'\n                disabled={busy}\n                rows={3}\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Virgülle ayrılmış (name, email, url) veya JSON array formatında ([&quot;name&quot;, &quot;email&quot;])\n              </p>\n            </div>\n\n            {/* Show detected variables if editing */}\n            {!isNew && (existingItem?.translations?.[0]?.detected_variables ?? []).length > 0 && (\n              <div className=\"space-y-2\">\n                <Label className=\"text-sm\">İçerikte Tespit Edilen Değişkenler</Label>\n                <div className=\"flex flex-wrap gap-1\">\n                  {(existingItem?.translations?.[0]?.detected_variables ?? []).map((v) => (\n                    <Badge key={v} variant=\"secondary\">\n                      {v}\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Actions */}\n        <Card>\n          <CardContent className=\"flex flex-col gap-3 pt-6 sm:flex-row sm:justify-between\">\n            <div>\n              {!isNew && (\n                <Button\n                  type=\"button\"\n                  variant=\"destructive\"\n                  onClick={handleDeleteClick}\n                  disabled={busy}\n                  className=\"gap-2\"\n                >\n                  {isDeleting ? (\n                    <>\n                      <Loader2 className=\"size-4 animate-spin\" />\n                      Siliniyor...\n                    </>\n                  ) : (\n                    <>\n                      <Trash2 className=\"size-4\" />\n                      Sil\n                    </>\n                  )}\n                </Button>\n              )}\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => router.push('/admin/email-templates')}\n                disabled={busy}\n              >\n                İptal\n              </Button>\n              <Button type=\"submit\" disabled={busy} className=\"gap-2\">\n                {isCreating || isUpdating ? (\n                  <>\n                    <Loader2 className=\"size-4 animate-spin\" />\n                    Kaydediliyor...\n                  </>\n                ) : (\n                  <>\n                    <Save className=\"size-4\" />\n                    Kaydet\n                  </>\n                )}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </form>\n\n      {/* Delete Dialog */}\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Silmek istediğinizden emin misiniz?</AlertDialogTitle>\n            <AlertDialogDescription>\n              <strong>{formData.template_key || 'Bu şablon'}</strong> silinecek. Bu işlem geri alınamaz.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>İptal</AlertDialogCancel>\n            <AlertDialogAction onClick={handleDeleteConfirm}>Sil</AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}