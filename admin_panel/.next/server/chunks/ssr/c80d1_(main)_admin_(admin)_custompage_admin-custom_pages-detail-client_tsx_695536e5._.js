module.exports=[73610,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(23292),f=a.i(28551),g=a.i(90899),h=a.i(30637);a.i(58501);var i=a.i(14610),j=a.i(1229),k=a.i(42737),l=a.i(99833);let m=({values:a,disabled:c,slugTouched:d,setSlugTouched:e,setValues:f,handleChange:g,handleCheckboxChange:h})=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{id:"is_published",type:"checkbox",className:"h-4 w-4",checked:a.is_published,onChange:h("is_published"),disabled:c}),(0,b.jsx)("span",{children:"Yayında olsun"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Başlık"}),(0,b.jsx)("input",{type:"text",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",value:a.title,onChange:a=>{let b=a.target.value;f(a=>{let c={...a,title:b};return d||(c.slug=(a=>{if(!a)return"";let b=a.trim(),c={ç:"c",Ç:"c",ğ:"g",Ğ:"g",ı:"i",I:"i",İ:"i",ö:"o",Ö:"o",ş:"s",Ş:"s",ü:"u",Ü:"u"};return(b=(b=b.split("").map(a=>c[a]??a).join("")).replace(/ß/g,"ss").replace(/ẞ/g,"ss")).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-")})(b)),c})},disabled:c,required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Slug"}),(0,b.jsx)("input",{type:"text",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",value:a.slug,onFocus:()=>e(!0),onChange:a=>{e(!0),f(b=>({...b,slug:a.target.value}))},disabled:c,required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Özet (Summary)"}),(0,b.jsx)("textarea",{className:"w-full rounded-md border bg-background px-3 py-2 text-sm",rows:3,value:a.summary,onChange:g("summary"),disabled:c})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-muted-foreground",children:"İçerik (zengin metin / HTML)"}),(0,b.jsx)(l.default,{value:a.content,disabled:c,onChange:a=>f(b=>({...b,content:a}))})]})]});var n=a.i(56414);let o=({values:a,disabled:c,imageMetadata:d,contentImageSize:e,setContentImageSize:f,contentImagePreview:g,handleAddContentImage:h,manualImageUrl:i,manualImageAlt:j,setManualImageUrl:k,setManualImageAlt:l,handleAddManualImage:m,setValues:o})=>(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-3 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Etiketler (Tags)"}),(0,b.jsx)("input",{type:"text",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",placeholder:"ör: guezelwebdesign, kampanya, blog",value:a.tags,onChange:a=>o(b=>({...b,tags:a.target.value})),disabled:c})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"İçerik Görsel Boyutu"}),(0,b.jsxs)("select",{className:"w-full rounded-md border bg-background px-2 py-2 text-sm",value:e,onChange:a=>f(a.target.value),disabled:c,children:[(0,b.jsx)("option",{value:"sm",children:"Küçük (1/2)"}),(0,b.jsx)("option",{value:"md",children:"Orta (3/4)"}),(0,b.jsx)("option",{value:"lg",children:"Büyük (varsayılan)"}),(0,b.jsx)("option",{value:"full",children:"Tam genişlik"})]})]}),(0,b.jsx)(n.AdminImageUploadField,{label:"İçerik Görselleri (Yükle)",helperText:(0,b.jsx)(b.Fragment,{children:"Yüklenen görsel içerik alanının sonuna blok olarak eklenir."}),bucket:"public",folder:"custom_pages/content",metadata:{...d||{},section:"content"},multiple:!0,value:g,onChange:a=>h(a),disabled:c,openLibraryHref:"/admin/storage"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-xs text-muted-foreground",children:"Serbest URL ile İçerik Görseli"}),(0,b.jsx)("input",{type:"url",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",placeholder:"https://... (görsel URL'i)",value:i,onChange:a=>k(a.target.value),disabled:c}),(0,b.jsx)("input",{type:"text",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",placeholder:"Alt metin (opsiyonel)",value:j,onChange:a=>l(a.target.value),disabled:c}),(0,b.jsx)("button",{type:"button",className:"rounded-md border px-3 py-2 text-xs disabled:opacity-60",onClick:m,disabled:c,children:"Serbest URL'yi İçeriğe Ekle"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Meta Title"}),(0,b.jsx)("input",{type:"text",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",value:a.meta_title,onChange:a=>o(b=>({...b,meta_title:a.target.value})),disabled:c})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"mb-1 block text-xs text-muted-foreground",children:"Meta Description"}),(0,b.jsx)("textarea",{className:"w-full rounded-md border bg-background px-3 py-2 text-sm",rows:3,value:a.meta_description,onChange:a=>o(b=>({...b,meta_description:a.target.value})),disabled:c})]})]}),p=({metadata:a,disabled:c,featuredImageValue:e,onFeaturedImageChange:f,galleryUrls:g,onGalleryUrlsChange:h,onSelectAsCover:i})=>{let j=(0,d.useRouter)();return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.AdminImageUploadField,{label:"Öne Çıkan Görsel (Kapak)",helperText:(0,b.jsxs)(b.Fragment,{children:["Bu sayfa için bir ",(0,b.jsx)("strong",{children:"kapak/öne çıkan"})," görsel yükleyebilirsin. Seçim"," ",(0,b.jsx)("code",{children:"custom_pages.featured_image"})," alanına yazılır."]}),bucket:"public",folder:"custom_pages/cover",metadata:{...a||{},section:"cover"},value:e,onChange:a=>f(a),disabled:c,openLibraryHref:"/admin/storage",onOpenLibraryClick:()=>j.push("/admin/storage")}),h?(0,b.jsx)(n.AdminImageUploadField,{label:"Galeri Görselleri",helperText:(0,b.jsxs)(b.Fragment,{children:["Birden fazla görsel yükleyip sayfaya galeri tanımlayabilirsin. Galerideki"," ",(0,b.jsx)("strong",{children:"Kapak"})," butonu ile seçilen görseli kapak olarak atayabilirsin."]}),bucket:"public",folder:"custom_pages/gallery",metadata:{...a||{},section:"gallery"},multiple:!0,values:g??[],onChangeMultiple:h,onSelectAsCover:a=>i?i(a):f(a),coverValue:e,disabled:c,openLibraryHref:"/admin/storage",onOpenLibraryClick:()=>j.push("/admin/storage")}):null]})},q=a=>String(a??"").trim().toLowerCase().replace("_","-").split("-")[0].trim(),r=(a,b="de")=>q(a?.locale_resolved??a?.locale??b)||q(b)||"de",s=(a,b)=>{let c=q(b||"de")||"de";if(!a)return{id:void 0,page_id:void 0,locale:c,is_published:!1,title:"",slug:"",content:"",featured_image:"",featured_image_asset_id:"",featured_image_alt:"",summary:"",meta_title:"",meta_description:"",tags:"",images:[],storage_image_ids:[]};let d=Array.isArray(a?.tags)&&a.tags.length?a.tags.join(", "):a.tags_raw??"",e=r(a,c);return{id:a.id,page_id:a.id,locale:e,is_published:!!a.is_published,title:a.title??"",slug:a.slug??"",content:a.content??a.content_html??"",featured_image:a.featured_image??"",featured_image_asset_id:a.featured_image_asset_id??"",featured_image_alt:a.featured_image_alt??"",summary:a.summary??"",meta_title:a.meta_title??"",meta_description:a.meta_description??"",tags:d,images:Array.isArray(a.images)?a.images:[],storage_image_ids:Array.isArray(a.storage_image_ids)?a.storage_image_ids:[]}},t=({mode:a,initialData:d,loading:f,saving:g,locales:h,localesLoading:l,defaultLocale:n,onLocaleChange:t,onSubmit:u,onCancel:v})=>{let w=q(n||"de")||"de",[x,y]=(0,c.useState)(s(d,w)),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)("form"),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)("lg"),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,{isLoading:M}]=(0,i.useLazyListCustomPagesAdminQuery)(),N=(0,c.useRef)(0),O=(0,c.useRef)("");(0,c.useEffect)(()=>{if(!d){y(s(void 0,w)),A(!1),O.current="";return}let b=r(d,w),c=q(O.current||"");"edit"===a&&c&&b!==c||(O.current="",y(s(d,w)),A(!1))},[d,w,a]),(0,c.useEffect)(()=>{x.locale||y(a=>({...a,locale:w}))},[x.locale,w]);let P=f||g,Q=async b=>{let c=q(b||w)||w;if(q(x.locale)===c)return void t?.(c);if(t?.(c),"create"===a||!d)return void y(a=>({...a,locale:c}));let f=d.id;if(!f)return void y(a=>({...a,locale:c}));O.current=c;let g=++N.current;y(a=>({...a,locale:c}));try{let a=await L({locale:c||void 0,limit:200,offset:0}).unwrap();if(g!==N.current)return;let b=(a?.items??a??[]).find(a=>String(a?.id||"")===String(f));if(b){let a=s(b,w);a.locale=c,y(a),A(!1),O.current=""}else e.toast.info("Seçilen dil için kayıt bulunamadı; bu dilde yeni içerik oluşturabilirsin.")}catch(a){if(g!==N.current)return;400===(a?.status??a?.originalStatus)?e.toast.info("Seçilen dil için kayıt listesi alınamadı; bu dilde yeni içerik oluşturabilirsin."):e.toast.error("Seçilen dil için özel sayfa yüklenirken bir hata oluştu.")}},R=(0,c.useMemo)(()=>(h??[]).map(a=>({value:q(a.value),label:a.label})),[h]),S=(0,c.useMemo)(()=>({module_key:"custom_pages",locale:x.locale||w,page_slug:x.slug||x.title||"",...x.page_id||d?.id?{page_id:x.page_id??d?.id}:{}}),[x.locale,x.slug,x.title,x.page_id,w,d?.id]),T=(a,b)=>{if(!a)return;let c=((a,b="",c="lg")=>{let d=b.replace(/"/g,"&quot;");return`
<figure class="content-image-block content-image-${c}">
  <img src="${a}" alt="${d}" loading="lazy" />
</figure>
`.trim()})(a,b??"",F);E(a),y(a=>({...a,content:(a.content||"")+"\n\n"+c+"\n\n"})),e.toast.success("Görsel içerik alanına eklendi. Editörde yerini değiştirebilirsin.")};return(0,b.jsx)("form",{onSubmit:a=>{if(a.preventDefault(),!P){if(!x.title.trim()||!x.slug.trim())return void e.toast.error("Başlık ve slug alanları zorunludur.");u({...x,page_id:x.page_id??d?.id??void 0,locale:q(x.locale||w)||w,title:x.title.trim(),slug:x.slug.trim(),summary:x.summary.trim(),meta_title:x.meta_title.trim(),meta_description:x.meta_description.trim(),tags:x.tags.trim()})}},className:"space-y-4",children:(0,b.jsxs)("div",{className:"rounded-lg border bg-card",children:[(0,b.jsx)("div",{className:"border-b p-3",children:(0,b.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"create"===a?"Yeni Sayfa Oluştur":"Sayfa Düzenle"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Başlık, slug, içerik, etiketler ve SEO alanlarını doldur."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsxs)("div",{className:"inline-flex overflow-hidden rounded-md border",children:[(0,b.jsx)("button",{type:"button",className:["px-3 py-1 text-xs","form"===B?"bg-muted font-semibold":"bg-background"].join(" "),onClick:()=>C("form"),disabled:P,children:"Form"}),(0,b.jsx)("button",{type:"button",className:["px-3 py-1 text-xs","json"===B?"bg-muted font-semibold":"bg-background"].join(" "),onClick:()=>C("json"),disabled:P,children:"JSON"})]}),v?(0,b.jsx)("button",{type:"button",className:"rounded-md border px-3 py-1 text-xs",onClick:v,disabled:P,children:"Geri"}):null,(0,b.jsx)("button",{type:"submit",className:"rounded-md bg-primary px-3 py-1 text-xs text-primary-foreground disabled:opacity-60",disabled:P,children:g?"create"===a?"Oluşturuluyor...":"Kaydediliyor...":"create"===a?"Sayfayı Oluştur":"Değişiklikleri Kaydet"}),f||M?(0,b.jsx)("span",{className:"rounded-full border px-2 py-0.5 text-[11px] text-muted-foreground",children:M?"Dil değiştiriliyor...":"Yükleniyor..."}):null]})]})}),(0,b.jsx)("div",{className:"p-3",children:"json"===B?(0,b.jsx)(j.AdminJsonEditor,{value:x,disabled:P,onChange:a=>y(a),label:"Custom Page JSON",helperText:"Bu JSON, formdaki tüm alanların bire bir karşılığıdır."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)(k.AdminLocaleSelect,{value:x.locale,onChange:Q,options:R,loading:!!l,disabled:P||!!l&&!R.length||M,label:"Dil"}),(0,b.jsx)("div",{className:"mt-1 text-xs text-muted-foreground",children:"Seçim; aynı zamanda düzenlediğin locale kaydını belirler."})]}),(0,b.jsxs)("div",{className:"grid gap-4 lg:grid-cols-12",children:[(0,b.jsx)("div",{className:"lg:col-span-8",children:(0,b.jsx)(m,{values:x,disabled:P,slugTouched:z,setSlugTouched:A,setValues:y,handleChange:a=>b=>{let c=b.target.value;y(b=>({...b,[a]:c}))},handleCheckboxChange:a=>b=>{let c=b.target.checked;y(b=>({...b,[a]:c}))}})}),(0,b.jsxs)("div",{className:"lg:col-span-4 space-y-4",children:[(0,b.jsx)(p,{metadata:S,disabled:P,featuredImageValue:x.featured_image,onFeaturedImageChange:a=>y(b=>({...b,featured_image:a})),galleryUrls:x.images,onGalleryUrlsChange:a=>y(b=>({...b,images:a})),onSelectAsCover:a=>y(b=>({...b,featured_image:a}))}),(0,b.jsx)(o,{values:x,disabled:P,imageMetadata:S,contentImageSize:F,setContentImageSize:G,contentImagePreview:D,handleAddContentImage:T,manualImageUrl:H,manualImageAlt:J,setManualImageUrl:I,setManualImageAlt:K,handleAddManualImage:()=>{let a=H.trim();a?(T(a,J.trim()),I(""),K("")):e.toast.error("Lütfen geçerli bir görsel URL'i gir.")},setValues:y})]})]})]})})]})})};function u(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a)}function v({id:a}){let j=(0,d.useRouter)(),k="new"===String(a),{localeOptions:l,defaultLocaleFromDb:m,loading:n,fetching:o}=(0,f.useAdminLocales)(),p=c.useMemo(()=>(0,g.resolveAdminApiLocale)(l,m,"tr"),[l,m]),q=c.useMemo(()=>new Set((l??[]).map(a=>(0,h.localeShortClient)(a.value)).filter(Boolean)),[l]),[r,s]=c.useState("");c.useEffect(()=>{l&&0!==l.length&&s(a=>{let b=(0,h.localeShortClient)(a);return b&&q.has(b)?b:(0,h.localeShortClientOr)(p,"tr")})},[l,q,p]);let v=c.useMemo(()=>{let a=(0,h.localeShortClient)(r);return a&&q.has(a)?a:(0,h.localeShortClientOr)(p,"tr")},[r,q,p]),w=!n&&!o,x=(l?.length??0)>0,[y,z]=(0,i.useLazyGetCustomPageAdminQuery)(),[A,B]=c.useState(void 0);c.useEffect(()=>{let b=!0;return async function(){if(!w||!x)return;if(k)return B(void 0);let c=String(a||"");if(u(c))try{let a=await y({id:c,locale:v}).unwrap();if(!b)return;B(a)}catch{if(!b)return;B(void 0)}}(),()=>{b=!1}},[a,k,w,x,v,y]);let[C,D]=(0,i.useCreateCustomPageAdminMutation)(),[E,F]=(0,i.useUpdateCustomPageAdminMutation)(),G=n||o||z.isLoading||z.isFetching,H=D.isLoading||F.isLoading,I=G||H,J=c.useMemo(()=>(l??[]).map(a=>({value:String(a.value??""),label:String(a.label??a.value??"")})),[l]),K=k?"create":"edit",L=()=>j.push("/admin/custompage"),M=async b=>{try{let c=(0,h.localeShortClientOr)(b.locale||v||p,"tr");if(q.size>0&&!q.has((0,h.localeShortClient)(c)))return void e.toast.error("Geçerli bir locale seçilmedi. app_locales ve default_locale kontrol edin.");if("create"===K){let a={locale:c,title:b.title.trim(),slug:b.slug.trim(),content:b.content??"",is_published:!!b.is_published,summary:b.summary.trim()||null,tags:b.tags.trim()||null,featured_image:b.featured_image.trim()||null,featured_image_asset_id:b.featured_image_asset_id.trim()||null,featured_image_alt:b.featured_image_alt.trim()||null,meta_title:b.meta_title.trim()||null,meta_description:b.meta_description.trim()||null,images:Array.isArray(b.images)?b.images:[],storage_image_ids:Array.isArray(b.storage_image_ids)?b.storage_image_ids:[]},d=await C(a).unwrap(),f=String(d?.id??"").trim();if(!f||!u(f))return void e.toast.error("Oluşturuldu ama id dönmedi/UUID değil. Backend response'u kontrol et.");e.toast.success("Sayfa başarıyla oluşturuldu."),j.replace(`/admin/custompage/${encodeURIComponent(f)}`),j.refresh();return}let d=A?.id||b.page_id||a;if(!d||!u(String(d)))return void e.toast.error("Sayfa verisi yüklenemedi (id yok).");let f={locale:c,title:b.title.trim(),slug:b.slug.trim(),content:b.content??"",is_published:!!b.is_published,summary:b.summary.trim()||null,tags:b.tags.trim()||null,featured_image:b.featured_image.trim()||null,featured_image_asset_id:b.featured_image_asset_id.trim()||null,featured_image_alt:b.featured_image_alt.trim()||null,meta_title:b.meta_title.trim()||null,meta_description:b.meta_description.trim()||null,images:Array.isArray(b.images)?b.images:[],storage_image_ids:Array.isArray(b.storage_image_ids)?b.storage_image_ids:[]};await E({id:d,patch:f}).unwrap(),e.toast.success("Sayfa güncellendi."),c!==v&&s(c)}catch(a){e.toast.error(function(a){let b=a?.data?.error?.message;if("string"==typeof b&&b.trim())return b;let c=a?.data?.message;if("string"==typeof c&&c.trim())return c;let d=a?.error;return"string"==typeof d&&d.trim()?d:"İşlem başarısız. Lütfen tekrar deneyin."}(a))}};return w&&!x?(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"Dil listesi bulunamadı"}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-muted-foreground",children:[(0,b.jsx)("code",{children:"site_settings.app_locales"})," boş veya geçersiz. Önce Site Settings’ten dilleri ayarlayın."]})]}):k||u(String(a||""))?(0,b.jsx)(t,{mode:K,initialData:A,loading:I,saving:H,locales:J,localesLoading:n||o,defaultLocale:v||p||"tr",onLocaleChange:a=>s((0,h.localeShortClientOr)(a,"tr")),onSubmit:M,onCancel:L}):(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"Geçersiz ID"}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-muted-foreground",children:["UUID değil: ",(0,b.jsx)("code",{children:String(a||"-")})]}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)("button",{className:"rounded-md border px-3 py-2 text-xs",onClick:L,children:"Listeye dön"})})]})}a.s(["default",()=>v],73610)}];

//# sourceMappingURL=c80d1_%28main%29_admin_%28admin%29_custompage_admin-custom_pages-detail-client_tsx_695536e5._.js.map