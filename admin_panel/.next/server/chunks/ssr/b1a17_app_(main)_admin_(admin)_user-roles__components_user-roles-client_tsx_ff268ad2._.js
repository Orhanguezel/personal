module.exports=[72973,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(23292),e=a.i(15618),f=a.i(81560),g=a.i(28790),h=a.i(69012),i=a.i(99570),j=a.i(70430),k=a.i(86304),l=a.i(80701),m=a.i(91119),n=a.i(6015);a.i(58501);var o=a.i(82096),p=a.i(41784),q=a.i(79755);function r(){let a=(0,q.useAdminT)();function r(b){return"admin"===b?a("admin.userRoles.roles.admin"):"moderator"===b?a("admin.userRoles.roles.moderator"):a("admin.userRoles.roles.user")}function s(b){let c=String(b.full_name??"").trim();return c.length?c:a("admin.userRoles.user.unknown")}function t(b){let c=b?.data?.error?.message;if("string"==typeof c&&c.trim())return c;let d=b?.data?.error;if("string"==typeof d&&d.trim())return d;let e=b?.data?.message;if("string"==typeof e&&e.trim())return e;let f=b?.error;return"string"==typeof f&&f.trim()?f:a("admin.userRoles.errorFallback")}let u=(0,p.useAdminListQuery)({limit:200,offset:0,sort:"created_at",order:"desc"},{refetchOnMountOrArgChange:!0}),v=c.useMemo(()=>{let a=(u.data??[]).map(a=>({id:a.id,name:s(a)}));return a.sort((a,b)=>a.name.localeCompare(b.name,"tr")),a},[u.data]),[w,x]=c.useState("all"),[y,z]=c.useState("all"),[A,B]=c.useState(50),C=c.useMemo(()=>({..."all"!==w?{user_id:w}:{},..."all"!==y?{role:y}:{},order:"created_at",direction:"desc",limit:A,offset:0}),[w,y,A]),D=(0,o.useAdminUserRolesListQuery)(C),[E,F]=(0,o.useAdminUserRoleCreateMutation)(),[G,H]=(0,o.useAdminUserRoleDeleteMutation)(),[I,J]=c.useState(()=>new Map);c.useEffect(()=>{u.data?.length&&J(a=>{let b=new Map(a);for(let a of u.data??[])b.set(a.id,a);return b})},[u.data]);let K=c.useMemo(()=>{let a=new Set;for(let b of D.data??[]){if(!b?.user_id)continue;let c=String(b.user_id);I.has(c)||a.add(c)}return Array.from(a)},[D.data,I]),[L,M]=c.useState([]),[N,O]=c.useState("");c.useEffect(()=>{K.length&&M(a=>{let b=new Set(a),c=K.filter(a=>!b.has(a));return c.length?[...a,...c]:a})},[K]),c.useEffect(()=>{N||L.length&&(O(L[0]),M(a=>a.slice(1)))},[L,N]);let P=(0,p.useAdminGetQuery)({id:N},{skip:!N,refetchOnMountOrArgChange:!0});function Q(b){let c=I.get(b);return c?{text:s(c),status:"ok"}:N===b&&P.isFetching||L.includes(b)?{text:a("admin.userRoles.user.loading"),status:"loading"}:{text:a("admin.userRoles.user.notFound"),status:"missing"}}c.useEffect(()=>{if(N){if(P.isError)return void O("");P.data&&(J(a=>{let b=new Map(a);return b.set(N,P.data),b}),O(""))}},[N,P.data,P.isError]);let R=c.useMemo(()=>v.slice(),[v]),[S,T]=c.useState(""),[U,V]=c.useState("user"),W=D.isFetching||F.isLoading||H.isLoading||u.isFetching||u.isLoading||P.isFetching;async function X(b){if(b.preventDefault(),!S)return void d.toast.error(a("admin.userRoles.create.selectUser"));try{await E({user_id:S,role:U}).unwrap(),d.toast.success(a("admin.userRoles.create.added")),T(""),V("user"),D.refetch()}catch(c){let b=t(c);d.toast.error("user_role_already_exists"===b?a("admin.userRoles.create.alreadyExists"):b)}}async function Y(b){if(confirm(a("admin.userRoles.table.deleteConfirm",{user:Q(b.user_id).text,role:r(b.role)})))try{await G({id:b.id}).unwrap(),d.toast.success(a("admin.userRoles.table.deleted")),D.refetch()}catch(a){d.toast.error(t(a))}}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-lg font-semibold",children:a("admin.userRoles.title")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a("admin.userRoles.description")})]}),(0,b.jsxs)(m.Card,{children:[(0,b.jsxs)(m.CardHeader,{children:[(0,b.jsx)(m.CardTitle,{className:"text-base",children:a("admin.userRoles.create.title")}),(0,b.jsx)(m.CardDescription,{children:a("admin.userRoles.create.description")})]}),(0,b.jsx)(m.CardContent,{children:(0,b.jsxs)("form",{onSubmit:X,className:"grid gap-3 md:grid-cols-3 md:items-end",children:[(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)(j.Label,{children:a("admin.userRoles.create.userLabel")}),(0,b.jsxs)(l.Select,{value:S,onValueChange:a=>T(a),disabled:W,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-full",children:(0,b.jsx)(l.SelectValue,{placeholder:u.isFetching?a("admin.userRoles.create.usersLoading"):a("admin.userRoles.create.userPlaceholder")})}),(0,b.jsx)(l.SelectContent,{children:R.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id,children:a.name},a.id))})]}),u.isError?(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:[a("admin.userRoles.create.usersLoadError")," ",(0,b.jsx)(i.Button,{type:"button",variant:"link",className:"px-1",onClick:()=>u.refetch(),children:a("admin.userRoles.create.retryButton")})]}):null]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:a("admin.userRoles.create.roleLabel")}),(0,b.jsxs)(l.Select,{value:U,onValueChange:a=>V(a),disabled:W,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-full",children:(0,b.jsx)(l.SelectValue,{placeholder:a("admin.userRoles.create.rolePlaceholder")})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"admin",children:a("admin.userRoles.roles.admin")}),(0,b.jsx)(l.SelectItem,{value:"moderator",children:a("admin.userRoles.roles.moderator")}),(0,b.jsx)(l.SelectItem,{value:"user",children:a("admin.userRoles.roles.user")})]})]})]}),(0,b.jsx)("div",{className:"md:col-span-3 flex justify-end",children:(0,b.jsxs)(i.Button,{type:"submit",disabled:W||!S,children:[(0,b.jsx)(e.Plus,{className:"mr-2 size-4"}),a("admin.userRoles.create.addButton")]})})]})})]}),(0,b.jsxs)(m.Card,{children:[(0,b.jsxs)(m.CardHeader,{className:"gap-2",children:[(0,b.jsx)(m.CardTitle,{className:"text-base",children:a("admin.userRoles.list.title")}),(0,b.jsx)(m.CardDescription,{children:a("admin.userRoles.list.description")})]}),(0,b.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-end",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(j.Label,{children:a("admin.userRoles.list.userFilterLabel")}),(0,b.jsxs)(l.Select,{value:w,onValueChange:a=>x(a),disabled:W,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-full",children:(0,b.jsx)(l.SelectValue,{placeholder:a("admin.userRoles.list.all")})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"all",children:a("admin.userRoles.list.all")}),R.map(a=>(0,b.jsx)(l.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"w-full space-y-2 lg:w-56",children:[(0,b.jsx)(j.Label,{children:a("admin.userRoles.list.roleFilterLabel")}),(0,b.jsxs)(l.Select,{value:y,onValueChange:a=>z(a),disabled:W,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-full",children:(0,b.jsx)(l.SelectValue,{placeholder:a("admin.userRoles.list.all")})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"all",children:a("admin.userRoles.list.all")}),(0,b.jsx)(l.SelectItem,{value:"admin",children:a("admin.userRoles.roles.admin")}),(0,b.jsx)(l.SelectItem,{value:"moderator",children:a("admin.userRoles.roles.moderator")}),(0,b.jsx)(l.SelectItem,{value:"user",children:a("admin.userRoles.roles.user")})]})]})]}),(0,b.jsxs)("div",{className:"w-full space-y-2 lg:w-44",children:[(0,b.jsx)(j.Label,{children:a("admin.userRoles.list.limitLabel")}),(0,b.jsxs)(l.Select,{value:String(A),onValueChange:a=>B(Number(a)),disabled:W,children:[(0,b.jsx)(l.SelectTrigger,{className:"w-full",children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"20",children:"20"}),(0,b.jsx)(l.SelectItem,{value:"50",children:"50"}),(0,b.jsx)(l.SelectItem,{value:"100",children:"100"}),(0,b.jsx)(l.SelectItem,{value:"200",children:"200"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Filter,{className:"size-4 text-muted-foreground"}),(0,b.jsx)(i.Button,{type:"button",variant:"ghost",onClick:()=>D.refetch(),disabled:W,title:a("admin.userRoles.list.refreshButton"),children:(0,b.jsx)(g.RefreshCcw,{className:"size-4"})})]})]}),D.isError?(0,b.jsxs)("div",{className:"rounded-md border p-4 text-sm",children:[a("admin.userRoles.list.loadError")," ",(0,b.jsx)(i.Button,{variant:"link",className:"px-1",onClick:()=>D.refetch(),children:a("admin.userRoles.list.retryButton")})]}):null,(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:a("admin.userRoles.table.userColumn")}),(0,b.jsx)(n.TableHead,{children:a("admin.userRoles.table.roleColumn")}),(0,b.jsx)(n.TableHead,{children:a("admin.userRoles.table.createdColumn")}),(0,b.jsx)(n.TableHead,{className:"text-right",children:a("admin.userRoles.table.actionColumn")})]})}),(0,b.jsxs)(n.TableBody,{children:[(D.data??[]).map(c=>{let d=Q(c.user_id);return(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"text-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"truncate font-medium",children:d.text}),"loading"===d.status?(0,b.jsx)(k.Badge,{variant:"secondary",children:a("admin.userRoles.table.loading")}):null,"missing"===d.status?(0,b.jsx)(k.Badge,{variant:"outline",children:a("admin.userRoles.table.notFound")}):null]})}),(0,b.jsx)(n.TableCell,{children:(0,b.jsx)(k.Badge,{variant:"admin"===c.role?"default":"secondary",children:r(c.role)})}),(0,b.jsx)(n.TableCell,{className:"text-muted-foreground",children:c.created_at?new Date(c.created_at).toLocaleString():"â€”"}),(0,b.jsx)(n.TableCell,{className:"text-right",children:(0,b.jsxs)(i.Button,{size:"sm",variant:"destructive",onClick:()=>Y(c),disabled:W,children:[(0,b.jsx)(f.Trash2,{className:"mr-2 size-4"}),a("admin.userRoles.table.deleteButton")]})})]},c.id)}),D.isFetching||(D.data?.length??0)!==0?null:(0,b.jsx)(n.TableRow,{children:(0,b.jsx)(n.TableCell,{colSpan:4,className:"py-10 text-center text-muted-foreground",children:a("admin.userRoles.list.noRecords")})})]})]})}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a("admin.userRoles.list.note")})]})]})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=b1a17_app_%28main%29_admin_%28admin%29_user-roles__components_user-roles-client_tsx_ff268ad2._.js.map