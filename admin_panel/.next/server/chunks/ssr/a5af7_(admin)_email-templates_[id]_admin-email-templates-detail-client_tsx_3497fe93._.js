module.exports=[12912,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(23292),f=a.i(210),g=a.i(14548),h=a.i(81560),i=a.i(96221),j=a.i(53254),k=a.i(92258),l=a.i(28551),m=a.i(30637),n=a.i(99570),o=a.i(66718),p=a.i(70430),q=a.i(29246),r=a.i(91119),s=a.i(63658),t=a.i(86304),u=a.i(42737),v=a.i(86192);a.i(58501);var w=a.i(84296);function x(a){return a?.data?.error?.message||a?.data?.message||a?.message||"İşlem başarısız"}function y({id:a}){let y=(0,d.useRouter)(),z="new"===a,{localeOptions:A,defaultLocaleFromDb:B,coerceLocale:C,loading:D}=(0,l.useAdminLocales)(),{data:E,isLoading:F,error:G}=(0,w.useGetEmailTemplateAdminQuery)({id:a},{skip:z}),[H,{isLoading:I}]=(0,w.useCreateEmailTemplateAdminMutation)(),[J,{isLoading:K}]=(0,w.useUpdateEmailTemplateAdminMutation)(),[L,{isLoading:M}]=(0,w.useDeleteEmailTemplateAdminMutation)(),[N,O]=c.useState({template_key:"",template_name:"",subject:"",content:"",variables:"",is_active:!0,locale:B||(0,m.localeShortClientOr)("de","de")||""}),[P,Q]=c.useState(!1);c.useEffect(()=>{if(!z&&E){var a;let b=E.translations?.[0];O({template_key:E.template_key||"",template_name:b?.template_name||"",subject:b?.subject||"",content:b?.content||"",variables:(a=E.variables)&&0!==a.length?a.join(", "):"",is_active:E.is_active,locale:b?.locale||B||(0,m.localeShortClientOr)("de","de")||""})}},[E,z,B]),c.useEffect(()=>{z&&B&&!N.locale&&O(a=>({...a,locale:B}))},[z,B,N.locale]);let R=I||K||M||F,S=async b=>{if(b.preventDefault(),!N.template_key.trim())return void e.toast.error("Template Key gerekli");if(!N.template_name.trim())return void e.toast.error("Template Name gerekli");if(!N.subject.trim())return void e.toast.error("Subject gerekli");if(!N.content.trim())return void e.toast.error("Content gerekli");let c=(0,m.localeShortClient)(N.locale),d=function(a){let b=a.trim();if(!b)return null;if(b.startsWith("["))try{let a=JSON.parse(b);if(Array.isArray(a))return a.filter(a=>"string"==typeof a&&a.trim())}catch{}return b.split(",").map(a=>a.trim()).filter(Boolean)}(N.variables);try{if(z){let a={template_key:N.template_key.trim(),template_name:N.template_name.trim(),subject:N.subject.trim(),content:N.content.trim(),variables:d,is_active:N.is_active,locale:c};await H(a).unwrap(),e.toast.success("Şablon oluşturuldu"),y.push("/admin/email-templates")}else await J({id:a,body:{template_key:N.template_key.trim(),template_name:N.template_name.trim(),subject:N.subject.trim(),content:N.content.trim(),variables:d,is_active:N.is_active,locale:c}}).unwrap(),e.toast.success("Şablon güncellendi")}catch(a){e.toast.error(x(a))}},T=async()=>{if(!z)try{await L({id:a}).unwrap(),e.toast.success("Şablon silindi"),y.push("/admin/email-templates")}catch(a){e.toast.error(x(a))}};return G?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)(r.Card,{children:(0,b.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,b.jsxs)("div",{className:"text-destructive",children:["Kayıt yüklenemedi: ",x(G)]}),(0,b.jsxs)(n.Button,{variant:"outline",onClick:()=>y.push("/admin/email-templates"),className:"mt-4 gap-2",children:[(0,b.jsx)(f.ArrowLeft,{className:"size-4"}),"Listeye Dön"]})]})})}):!z&&F?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)(r.Card,{children:(0,b.jsx)(r.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Loader2,{className:"size-5 animate-spin"}),(0,b.jsx)("span",{children:"Yükleniyor..."})]})})})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,b.jsx)(r.Card,{children:(0,b.jsx)(r.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(r.CardTitle,{children:z?"Yeni Email Template":"Email Template Düzenle"}),(0,b.jsx)(r.CardDescription,{children:z?"Yeni bir email şablonu oluşturun":"Mevcut email şablonunu düzenleyin"})]}),(0,b.jsxs)(n.Button,{type:"button",variant:"outline",onClick:()=>y.push("/admin/email-templates"),disabled:R,className:"gap-2",children:[(0,b.jsx)(f.ArrowLeft,{className:"size-4"}),"Geri"]})]})})}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Genel Bilgiler"})}),(0,b.jsx)(r.CardContent,{className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,b.jsx)("div",{children:(0,b.jsx)(u.AdminLocaleSelect,{value:N.locale,onChange:a=>{let b=C(a,B);O(a=>({...a,locale:b}))},options:A,loading:D,disabled:R})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Label,{htmlFor:"is_active",className:"text-sm",children:"Durum"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 rounded-md border px-3 py-2",children:[(0,b.jsx)(s.Switch,{id:"is_active",checked:N.is_active,onCheckedChange:a=>O(b=>({...b,is_active:a})),disabled:R}),(0,b.jsx)(p.Label,{htmlFor:"is_active",className:"cursor-pointer text-sm",children:N.is_active?(0,b.jsx)(t.Badge,{variant:"default",children:"Aktif"}):(0,b.jsx)(t.Badge,{variant:"secondary",children:"Pasif"})})]})]})]})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Şablon Bilgileri"})}),(0,b.jsxs)(r.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Label,{htmlFor:"template_key",className:"text-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Code2,{className:"size-4"}),"Template Key ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]})}),(0,b.jsx)(o.Input,{id:"template_key",value:N.template_key,onChange:a=>O(b=>({...b,template_key:a.target.value})),placeholder:"welcome_email",disabled:R||!z,required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Benzersiz anahtar (değiştirilemez). Örn: welcome_email, password_reset"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(p.Label,{htmlFor:"template_name",className:"text-sm",children:["Template Name ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(o.Input,{id:"template_name",value:N.template_name,onChange:a=>O(b=>({...b,template_name:a.target.value})),placeholder:"Hoş Geldiniz Emaili",disabled:R,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Label,{htmlFor:"subject",className:"text-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Mail,{className:"size-4"}),"Subject ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]})}),(0,b.jsx)(o.Input,{id:"subject",value:N.subject,onChange:a=>O(b=>({...b,subject:a.target.value})),placeholder:"Hoş Geldiniz {{name}}!",disabled:R,required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email konusu. Değişkenler için {{variable}} kullanın."})]})]})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Email İçeriği"}),(0,b.jsx)(r.CardDescription,{children:"HTML içerik. Değişkenler için {{variable}} formatını kullanın."})]}),(0,b.jsx)(r.CardContent,{className:"space-y-6",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(p.Label,{htmlFor:"content",className:"text-sm",children:["HTML Content ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(q.Textarea,{id:"content",value:N.content,onChange:a=>O(b=>({...b,content:a.target.value})),placeholder:`<html>
  <body>
    <h1>Merhaba {{name}}!</h1>
    <p>Hoş geldiniz...</p>
  </body>
</html>`,disabled:R,rows:12,required:!0,className:"font-mono text-xs"})]})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{className:"text-base",children:"Değişkenler"}),(0,b.jsx)(r.CardDescription,{children:"Email içeriğinde kullanılan değişkenleri tanımlayın (opsiyonel)"})]}),(0,b.jsxs)(r.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Label,{htmlFor:"variables",className:"text-sm",children:"Variables"}),(0,b.jsx)(q.Textarea,{id:"variables",value:N.variables,onChange:a=>O(b=>({...b,variables:a.target.value})),placeholder:'name, email, url veya ["name", "email", "url"]',disabled:R,rows:3}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:'Virgülle ayrılmış (name, email, url) veya JSON array formatında (["name", "email"])'})]}),!z&&(E?.translations?.[0]?.detected_variables??[]).length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(p.Label,{className:"text-sm",children:"İçerikte Tespit Edilen Değişkenler"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:(E?.translations?.[0]?.detected_variables??[]).map(a=>(0,b.jsx)(t.Badge,{variant:"secondary",children:a},a))})]})]})]}),(0,b.jsx)(r.Card,{children:(0,b.jsxs)(r.CardContent,{className:"flex flex-col gap-3 pt-6 sm:flex-row sm:justify-between",children:[(0,b.jsx)("div",{children:!z&&(0,b.jsx)(n.Button,{type:"button",variant:"destructive",onClick:()=>{Q(!0)},disabled:R,className:"gap-2",children:M?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"size-4 animate-spin"}),"Siliniyor..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Trash2,{className:"size-4"}),"Sil"]})})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>y.push("/admin/email-templates"),disabled:R,children:"İptal"}),(0,b.jsx)(n.Button,{type:"submit",disabled:R,className:"gap-2",children:I||K?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"size-4 animate-spin"}),"Kaydediliyor..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Save,{className:"size-4"}),"Kaydet"]})})]})]})})]}),(0,b.jsx)(v.AlertDialog,{open:P,onOpenChange:Q,children:(0,b.jsxs)(v.AlertDialogContent,{children:[(0,b.jsxs)(v.AlertDialogHeader,{children:[(0,b.jsx)(v.AlertDialogTitle,{children:"Silmek istediğinizden emin misiniz?"}),(0,b.jsxs)(v.AlertDialogDescription,{children:[(0,b.jsx)("strong",{children:N.template_key||"Bu şablon"})," silinecek. Bu işlem geri alınamaz."]})]}),(0,b.jsxs)(v.AlertDialogFooter,{children:[(0,b.jsx)(v.AlertDialogCancel,{children:"İptal"}),(0,b.jsx)(v.AlertDialogAction,{onClick:T,children:"Sil"})]})]})})]})}a.s(["default",()=>y])}];

//# sourceMappingURL=a5af7_%28admin%29_email-templates_%5Bid%5D_admin-email-templates-detail-client_tsx_3497fe93._.js.map